(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{428:function(e,t,n){"use strict";var r=n(73);t.a={getTeacherList:function(e,t){return Object(r.a)({url:"/eduservice/teacherfront/getTeacherFrontList/".concat(e,"/").concat(t),method:"post"})},getTeacherInfo:function(e){return Object(r.a)({url:"/eduservice/teacherfront/getTeacherFrontInfo/".concat(e),method:"get"})}}},432:function(e,t,n){"use strict";var r=n(73);t.a={getAllLiving:function(){return Object(r.a)({url:"/live/aliyunLive/getAllLiving",method:"get"})},getLivingById:function(e){return Object(r.a)({url:"/live/aliyunLive/getLiveById/"+e,method:"get"})}}},452:function(e,t,n){var content=n(508);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(5).default)("33635750",content,!0,{sourceMap:!1})},507:function(e,t,n){"use strict";n(452)},508:function(e,t,n){var r=n(4)(!1);r.push([e.i,".chat[data-v-ed835c84]{overflow-y:scroll;background-color:#eee;height:680px;max-height:680px}.sendLine[data-v-ed835c84]{display:flex;width:100%}.sendBox[data-v-ed835c84]{position:absolute;bottom:0}.rightBox[data-v-ed835c84]{background-color:#fff}.contentLiving[data-v-ed835c84],.rightBox[data-v-ed835c84]{max-height:700px}.living[data-v-ed835c84],.livingInfo[data-v-ed835c84]{display:flex}.livingInfo[data-v-ed835c84]{margin-left:10px;flex-direction:column;justify-content:space-around}.itemsbg[data-v-ed835c84]{background-color:#40e0d0;color:#fff!important;border-radius:10px}.items[data-v-ed835c84],.itemsbg[data-v-ed835c84]{margin-left:10px}.items[data-v-ed835c84]{margin-top:5px}.item[data-v-ed835c84]{color:#eee}.outline[data-v-ed835c84]{height:775px}.bg[data-v-ed835c84],.outline[data-v-ed835c84]{background-color:#35383e}.bg[data-v-ed835c84]{z-index:9999999}.msgs[data-v-ed835c84]{height:87.5vh;padding:10upx;background-color:#eee;width:97%}.oneMsg[data-v-ed835c84]{line-height:2em}.other_user[data-v-ed835c84],.self-user[data-v-ed835c84]{color:#000}.field[data-v-ed835c84]{display:flex;flex-direction:row;align-items:center;margin:10upx}.field>.label[data-v-ed835c84]{width:4em;text-align:right}.textLine[data-v-ed835c84]{width:100%;display:flex;align-items:center;margin-bottom:10upx;margin-top:5px}.textTypeOwn[data-v-ed835c84]{background-color:#4cd964;color:#000}.textType[data-v-ed835c84],.textTypeOwn[data-v-ed835c84]{max-width:400upx;border-radius:10upx;box-shadow:3upx 3upx 3upx #e3e3e3;display:flex;align-items:center;justify-content:center;padding:10upx;flex-wrap:wrap}.textType[data-v-ed835c84]{background-color:#eee}.textType>view[data-v-ed835c84]{width:100%;font-size:28upx;color:#000;word-wrap:break-word;word-break:break-all;white-space:pre-line}.toLine[data-v-ed835c84]{color:#606266}.toLine>text[data-v-ed835c84]{background-color:#c0c4cc;margin:10upx}.scrollView[data-v-ed835c84]{width:750rpx}.inputStyle[data-v-ed835c84]{flex:80%}",""]),e.exports=r},537:function(e,t,n){"use strict";n.r(t);var r=n(3),o=(n(28),n(432)),c=n(428),d=n(2),l=n.n(d),v={layout:"video",asyncData:function(e){var t=e.params;e.error;return o.a.getLivingById(t.id).then((function(e){return{livingInfo:e.data.data.livingInfo,teacherId:t.id}}))},data:function(){return{player:{},flagIndex:-1,path:"ws://127.0.0.1:11000/living",teacherInfo:{},message:{},userInfo:{},messageValue:"",messageList:[],livingCount:0}},created:function(){console.log(this.livingInfo)},methods:{init:function(){var e=this;if("undefined"==typeof WebSocket)alert("您的浏览器不支持socket");else{var t=new WebSocket(this.path);this.socket=t,t.onopen=function(n){console.log("连接建立成功"),e.message.type=0,e.message.userId=e.userInfo.id,e.message.livingId=e.livingInfo.id,t.send(JSON.stringify(e.message))}}},getTeacherInfo:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.getTeacherInfo(e.teacherId);case 2:2e4===(n=t.sent).data.code&&(console.log(n.data.data.teacher),e.teacherInfo=n.data.data.teacher,console.log(e.teacherInfo));case 4:case"end":return t.stop()}}),t)})))()},sendDanmu:function(){var e=l.a.get("underdogedu_ucenter");if(null==e||null==e||""==e)this.$router.push("/login");else{this.userInfo=JSON.parse(e),this.message.type=1,this.message.userId=this.userInfo.id,this.message.livingId=this.livingInfo.id,this.message.message=this.messageValue,this.message.userAvatar=this.userInfo.avatar,this.socket.send(JSON.stringify(this.message));var t={type:1,msg:this.messageValue,avatar:this.userInfo.avatar};this.messageList.push(t),this.messageValue=""}}},mounted:function(){var e=this;this.getTeacherInfo(),this.init(),this.player=new Aliplayer({id:"J_prismPlayer",width:"100%",height:"630px",videoWidth:"100%",videoHeight:"100%",cover:"https://underdogedu.oss-cn-beijing.aliyuncs.com/%E7%B4%A0%E6%9D%90/1525939573202.jpg",qualitySort:"asc",mediaType:"video",autoplay:!1,isLive:!0,rePlay:!1,preload:!0,controlBarVisibility:"hover",useH5Prism:!1,useFlashPrism:!0,rtmpBufferTime:0,showBuffer:0,stashInitialSizeForFlv:30,source:this.livingInfo.pullUrl},(function(e){e.play()})),this.socket.onmessage=function(t){console.log("收到服务器内容："+t.data);var n=l.a.get("underdogedu_ucenter");if(JSON.parse(t.data).userId!=e.userInfo.id&&null!=n&&null!=n&&""!=n){var r={type:2,msg:JSON.parse(t.data).message,avatar:JSON.parse(t.data).userAvatar};e.messageList.push(r),e.livingCount=JSON.parse(t.data).count}else e.livingCount=JSON.parse(t.data).count}}},h=(n(507),n(11)),component=Object(h.a)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{}},[n("div",{staticClass:"fl col-8"},[n("link",{attrs:{rel:"stylesheet",href:"https://g.alicdn.com/de/prismplayer/2.8.1/skins/default/aliplayer-min.css"}}),e._v(" "),n("script",{attrs:{charset:"utf-8",type:"text/javascript",src:"https://g.alicdn.com/de/prismplayer/2.8.1/aliplayer-min.js"}}),e._v(" "),n("div",{staticClass:"living"},[n("el-avatar",{attrs:{src:e.teacherInfo.avatar,shape:"square",size:120}}),e._v(" "),n("div",{staticClass:"livingInfo"},[n("div",{staticStyle:{"font-size":"20px","font-weight":"bold"}},[e._v("\n          "+e._s(e.livingInfo.livingName)+"\n        ")]),e._v(" "),n("div",[e._v(e._s(e.livingInfo.descption))]),e._v(" "),n("div",[e._v("讲师名:"+e._s(e.livingInfo.teacherName))])]),e._v(" "),n("div",[e._v("当前在线人数:"+e._s(e.livingCount))])],1),e._v(" "),n("div",{staticClass:"prism-player",attrs:{id:"J_prismPlayer"}})]),e._v(" "),n("div",{staticClass:"fl col-2 rightBox"},[n("div",{staticClass:"chat",attrs:{id:"msg"}},e._l(e.messageList,(function(t,r){return n("div",{key:r,staticClass:"oneMsg"},[1==t.type?n("div",{staticClass:"textLine textUser",staticStyle:{"flex-direction":"row-reverse"}},[n("el-avatar",{staticStyle:{"margin-left":"5px"},attrs:{src:t.avatar,shape:"square",size:27}}),e._v(" "),n("text",{staticStyle:{margin:"0 10upx"}},[e._v(":")]),e._v(" "),n("div",{staticClass:"textTypeOwn"},[n("div",{staticClass:"other_user"},[e._v(e._s(t.msg))])])],1):e._e(),e._v(" "),2==t.type?n("div",{staticClass:"textLine textFriend"},[n("el-avatar",{staticStyle:{"margin-right":"5px"},attrs:{src:t.avatar,shape:"square",size:27}}),e._v(" "),n("text",{staticStyle:{margin:"0 .5em"}},[e._v(":")]),e._v(" "),n("div",{staticClass:"textType"},[n("div",{staticClass:"self-user"},[e._v(e._s(t.msg))])])],1):e._e()])})),0),e._v(" "),n("div",{staticClass:"sendBox"},[n("div",{staticClass:"sendLine"},[n("el-input",{staticStyle:{width:"230px"},model:{value:e.messageValue,callback:function(t){e.messageValue=t},expression:"messageValue"}}),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.sendDanmu}},[e._v("发送")])],1)])])])}),[],!1,null,"ed835c84",null);t.default=component.exports}}]);